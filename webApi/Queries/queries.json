{
  "queryPredictions": "WITH OrdenesConDiferencia AS (SELECT o.custid,o.orderdate,LAG(o.orderdate) OVER (PARTITION BY o.custid ORDER BY o.orderdate) AS OrdenAnterior FROM Sales.Orders o),Diferencias AS (SELECT custid,DATEDIFF(DAY, OrdenAnterior, orderdate) AS DiasEntreOrdenes FROM OrdenesConDiferencia WHERE OrdenAnterior IS NOT NULL),Promedios AS ( SELECT custid, AVG(DiasEntreOrdenes * 1.0) AS PromedioDiasEntreOrdenes FROM Diferencias GROUP BY custid),UltimaOrden AS (SELECT o.custid, MAX(o.orderdate) AS LastOrderDate FROM Sales.Orders o GROUP BY o.custid ) SELECT c.companyname AS CustomerName, c.custid, u.LastOrderDate, DATEADD(DAY, p.PromedioDiasEntreOrdenes, u.LastOrderDate) AS NextPredictedOrder FROM Sales.Customers c JOIN UltimaOrden u ON c.custid = u.custid JOIN Promedios p ON c.custid = p.custid ORDER BY NextPredictedOrder"
}
